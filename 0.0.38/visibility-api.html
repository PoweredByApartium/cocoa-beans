<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2025-07-08T12:31:57.839948934"><title>üëÅÔ∏è Visibility Api | Cocoa Beans</title><script type="application/json" id="virtual-toc-data">[{"id":"registering-and-using-the-api","level":0,"title":"Registering and using the API","anchor":"#registering-and-using-the-api"},{"id":"visibility-group","level":0,"title":"Visibility group","anchor":"#visibility-group"},{"id":"relevant-links","level":0,"title":"Relevant Links","anchor":"#relevant-links"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="üëÅÔ∏è Visibility Api | Cocoa Beans"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Cocoa Beans Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation//snapshot/visibility-api.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="üëÅÔ∏è Visibility Api | Cocoa Beans"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation//snapshot/visibility-api.html#webpage",
    "url": "writerside-documentation//snapshot/visibility-api.html",
    "name": "üëÅÔ∏è Visibility Api | Cocoa Beans",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Cocoa Beans Help"
}</script><!-- End Schema.org --></head><body data-id="Visibility-Api" data-main-title="üëÅÔ∏è Visibility Api" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="spigot.md|üö∞ Spigot"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Cocoa Beans snapshot Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Visibility-Api" id="Visibility-Api.md">üëÅÔ∏è Visibility Api</h1><p id="-75hbu2_3"><span class="control" id="-75hbu2_13">Table of content:</span></p><ul class="list _bullet" id="-75hbu2_4"><li class="list__item" id="-75hbu2_14"><p id="-75hbu2_18"><a href="#introduction" id="-75hbu2_19" data-tooltip="Table of content:">Introduction</a></p></li><li class="list__item" id="-75hbu2_15"><p id="-75hbu2_20"><a href="#registering-and-using-the-api" id="-75hbu2_21" data-tooltip="Each server should have only one manager could be create like so we will probably want to also register visibility manager">Using API</a></p></li><li class="list__item" id="-75hbu2_16"><p id="-75hbu2_22"><a href="#visibility-group" id="-75hbu2_23" data-tooltip="First, we will want to create group with VisibilityManager#getOrCreateGroup Groups are identified by their string id, if we invoke the method with the same param on the same instance we will receive the same group (identity is guaranteed). The following method creates a group for‚Ä¶">Visibility group</a></p></li><li class="list__item" id="-75hbu2_17"><p id="-75hbu2_24"><a href="#relevant-links" id="-75hbu2_25" data-tooltip="javadocs">Relevant links</a></p></li></ul><p id="-75hbu2_5"><span id="introduction">üëÅÔ∏è Visibility Api</span><br></p><p id="-75hbu2_6">The visibility API works on top of Bukkit's existing hidePlayer and showPlayer apis and provide a simpler way to use it for many cases. The visibility API works by a concept of groups, each group:</p><ul class="list _bullet" id="-75hbu2_7"><li class="list__item" id="-75hbu2_28"><p id="-75hbu2_31">Has its own members</p></li><li class="list__item" id="-75hbu2_29"><p id="-75hbu2_32">Can see specific groups</p></li><li class="list__item" id="-75hbu2_30"><p id="-75hbu2_33">Cannot see specific groups</p></li></ul><p id="-75hbu2_8">Recommended use cases:</p><ul class="list _bullet" id="-75hbu2_9"><li class="list__item" id="-75hbu2_34"><p id="-75hbu2_38">Multiple games in one server, <code class="code" id="-75hbu2_39">where players can only see their game</code></p></li><li class="list__item" id="-75hbu2_35"><p id="-75hbu2_40">Spectators, <code class="code" id="-75hbu2_41">Can see players and themselves but not vice-versa</code></p></li><li class="list__item" id="-75hbu2_36"><p id="-75hbu2_42">Vanish, <code class="code" id="-75hbu2_43">Can see other players but players shouldn't have the abilty to see them</code></p></li><li class="list__item" id="-75hbu2_37"><p id="-75hbu2_44">Each world has it's own players (For large open world servers), <code class="code" id="-75hbu2_45">Every world can only see it's own players</code></p></li></ul><section class="chapter"><h2 id="registering-and-using-the-api" data-toc="registering-and-using-the-api">Registering and using the API</h2><p id="-75hbu2_46">Each server should have only <span class="control" id="-75hbu2_52">one manager</span> could be create like so we will probably want to also register visibility manager</p><div class="code-block" data-lang="java">
public final class CocoaBeansSpigotLoader extends JavaPlugin {

    private VisibilityManager visibilityManager;
    
    @Override
    public void onEnable() {
        visibilityManager = new VisibilityManager(this);
        
        // Register listener
        visibilityManager.registerListener(); // You could also pass as a parameter VisibilityPlayerRemoveType as default it's VisibilityPlayerRemoveType.ON_LEAVE
    }

}

</div><p id="-75hbu2_48">When we call the function <code class="code" id="-75hbu2_53">VisibilityManager#registerListener</code> it will have <code class="code" id="-75hbu2_54">VisibilityPlayerRemoveType</code> of <code class="code" id="-75hbu2_55">ON_LEAVE</code>,</p><p id="-75hbu2_49">There are two types of <code class="code" id="-75hbu2_56">VisibilityPlayerRemoveType</code></p><ul class="list _bullet" id="-75hbu2_50"><li class="list__item" id="-75hbu2_57"><p id="-75hbu2_59"><span class="control" id="-75hbu2_60">ON_LEAVE</span> <code class="code" id="-75hbu2_61">Remove the player from in memory state when they quit</code></p></li><li class="list__item" id="-75hbu2_58"><p id="-75hbu2_62"><span class="control" id="-75hbu2_63">NEVER</span> <code class="code" id="-75hbu2_64">When the player will re-join the visibility policies will be automatically applied from the same group, but it can cause a memory leak (if we never clear it)</code></p></li></ul><p id="-75hbu2_51">When we use <code class="code" id="-75hbu2_65">VisibilityPlayerRemoveType.NEVER</code> we will want to handle removal by our self We could get all players in memory by calling the function <code class="code" id="-75hbu2_66">VisibilityManager#getPlayers</code> and stream to filter which players should be removes</p></section><section class="chapter"><h2 id="visibility-group" data-toc="visibility-group">Visibility group</h2><p id="-75hbu2_67">First, we will want to create group with <code class="code" id="-75hbu2_77">VisibilityManager#getOrCreateGroup</code> Groups are identified by their string id, if we invoke the method with the same param on the same instance we will receive the same group (identity is guaranteed). The following method creates a group for all players in the game. It means that the players in the game will only see each other and not other players on the server.</p><div class="code-block" data-lang="java">
public void addGame(VisibilityManager visibilityManager, Game game) {
    VisibilityGroup group = visibilityManager.getOrCreateGroup(&quot;skywars-&quot; + game.getUniqueId());
    
    for (Player target : game.getPlayers()) {
        gruop.addPlayer(target);
    }
}
</div><p id="-75hbu2_69">When the game is over we will probably want to delete all the groups we have created to avoid memory leaks.</p><div class="code-block" data-lang="java">
public void deleteGame(VisibilityManager visibilityManager, Game game) {
    visibilityManager.deleteGroup(&quot;skywars-&quot; + game.getUniqueId());
    visibilityManager.deleteGroup(&quot;skywars-&quot; + game.getUniqueId() + &quot;-spectator&quot;);
}
</div><p id="-75hbu2_71">When a player is removed from the game</p><div class="code-block" data-lang="java">
public void removePlayerFromGame(VisibilityManager visibilityManager, Game game, Player target) {
    VisibilityGroup group = visibilityManager.getOrCreateGroup(&quot;skywars-&quot; + game.getUniqueId());
    group.removePlayer(target);
}
</div><p id="-75hbu2_73">Initialize a spectator group. Players on the spectator group will be able to see players on the main group, but not vice versa.</p><div class="code-block" data-lang="java">
public void addSpectatorToGame(VisibilityManager visibilityManager, Game game) {
    VisibilityGroup mainGroup = visibilityManager.getOrCreateGroup(&quot;skywars-&quot; + game.getUniqueId());
    VisibilityGroup spectatorGroup = visibilityManager.getOrCreateGroup(&quot;skywars-&quot; + game.getUniqueId() + &quot;-spectator&quot;);

    // players on the spectators group can see players on the main group
    spectatorGroup.addVisibleGroup(mainGroup);
    
    // players on the main group cannot see players on the spectator group
    mainGroup.addHiddenGroup(spectatorGroup);
}
</div><p id="-75hbu2_75">Initialize a group of vanished admins, who can be seen by no-one except themselves.</p><div class="code-block" data-lang="java">
public void addVanishGroup(VisibilityManager visibilityManager) {
    VisibilityGroup vanishGroup = visibilityManager.getOrCreateGroup(&quot;vanish&quot;);

    // TODO add players to vanish group we will want to be vanish
    
    for (VisibilityGroup group : vanishGroup.getGroups()) {
        if (vanishGroup == group)
            continue;
        
        group.addHiddenGroup(vanishGroup);
    }
}
</div></section><section class="chapter"><h2 id="relevant-links" data-toc="relevant-links">Relevant Links</h2><ul class="list _bullet" id="-75hbu2_78"><li class="list__item" id="-75hbu2_79"><p id="-75hbu2_80"><a href="https://cocoa-beans.apartium.net/0.0.38/spigot/net/apartium/cocoabeans/spigot/visibility/package-summary.html" id="-75hbu2_81" data-external="true" rel="noopener noreferrer" target="_blank">javadocs</a></p></li></ul></section><div class="last-modified">08 July 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="minecraft-version.html" class="navigation-links__prev">üìú Minecraft Version</a><a href="collections.html" class="navigation-links__next">üìö Collections</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>